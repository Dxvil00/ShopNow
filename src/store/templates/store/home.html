{% extends 'store/index.html' %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

{% block content %}

<!-- Loading Screen -->
<div id="loading" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.9); display: flex; justify-content: center; align-items: center; z-index: 9999;">
    <div style="text-align: center;">
        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3" style="font-size: 1.25rem; color: #6c757d; font-weight: 500;">Please wait while we load the content...</p>
    </div>
</div>

<!-- Hero Section (Modern Layout) -->
<section class="hero-section py-5" style="background-color: #f9fafb; display: block;" id="content">
    <div class="container">
        <div class="row align-items-center">
            <!-- Left Text Content -->
            <div class="col-md-6 mb-4 mb-md-0">
                <h1 class="fw-bold display-5 mb-3">Discover Quality<br>Products for Every Need</h1>
                <p class="text-muted fs-5 mb-4">
                    Shop our curated collection of premium products with fast shipping and excellent customer service.
                </p>
                <div class="d-flex gap-3">
                    <a href="{% url 'products' %}" class="btn btn-dark btn-lg">Shop Now</a>
                    <a href="#" class="btn btn-outline-dark btn-lg">Browse Categories</a>
                </div>
            </div>

            <!-- Right Image -->
            <div class="col-md-6 text-center">
                <img src="/media/images/hero_img.jpeg" alt="Hero Image" class="img-fluid rounded shadow" style="max-height: 400px; object-fit: cover;">
            </div>
        </div>
    </div>
</section>



<!-- Featured Products Section -->
<section class="featured-products py-5" id="featured-products" style="display: none;">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2 class="fw-bold mb-1">Featured Products</h2>
                <p class="text-muted mb-0">Discover our handpicked selection of premium products.</p>
            </div>
            <a href="#" class="text-decoration-none fw-semibold">
                View All Products <i class="fas fa-arrow-right ms-1"></i>
            </a>
        </div>

        <div class="row" id="product-catalog">
            <!-- Dynamic Products will be inserted here -->
        </div>
    </div>
</section>

<script>
    const apiEndpoint = 'https://api.escuelajs.co/api/v1/products';
    const productsPerPage = 6;
    let allProducts = [];
    let currentPage = 1;
    let isLoading = false;
    let hasReachedEnd = false;

    async function fetchAllProducts() {
        try {
            const response = await fetch(apiEndpoint);
            allProducts = await response.json();
            loadMoreProducts(); // Load first batch
        } catch (error) {
            console.error('Failed to fetch products:', error);
        }
    }

    function loadMoreProducts() {
        if (isLoading || hasReachedEnd) return;
        isLoading = true;

        const startIndex = (currentPage - 1) * productsPerPage;
        const endIndex = startIndex + productsPerPage;
        const productsToShow = allProducts.slice(startIndex, endIndex);

        const productCatalog = document.getElementById('product-catalog');

        if (productsToShow.length === 0) {
            if (!hasReachedEnd) {
                const viewMoreCard = `
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 text-center border-0 bg-light d-flex flex-column justify-content-center align-items-center" style="min-height: 400px;">
                            <div class="p-4">
                                <h5 class="fw-bold text-muted mb-3">Interested for more?</h5>
                                <a href="#" class="btn btn-outline-dark">View More Products</a>
                            </div>
                        </div>
                    </div>
                `;
                productCatalog.insertAdjacentHTML('beforeend', viewMoreCard);
                hasReachedEnd = true;
            }
            isLoading = false;
            return;
        }

        productsToShow.forEach(product => {
            const truncatedTitle = product.title.length > 30 ? product.title.slice(0, 30) + "..." : product.title;
            const card = `
                <div class="col-md-4 mb-4">
                    <div class="card h-100 shadow-sm border-0 hover-shadow">
                    <div class="bg-white rounded-top overflow-hidden position-relative" style="height: 260px; display: flex; align-items: center; justify-content: center;">
                        <img src="${product.image}" class="img-fluid p-3" style="max-height: 100%; object-fit: contain;" alt="${product.title}">
                        <span class="badge bg-dark position-absolute top-0 start-0 m-2">${product.category.name}</span>
                    </div>
                    <div class="card-body d-flex flex-column justify-content-between">
                        <div>
                        <h6 class="fw-semibold text-truncate" title="${product.title}">${truncatedTitle}</h6>
                        <p class="fw-bold text-dark fs-5 mb-2">$${product.price.toFixed(2)}</p>
                        </div>
                        <a href="#" class="btn btn-outline-dark w-100 mt-auto">
                        <i class="fas fa-shopping-cart me-2"></i>Add to Cart
                        </a>
                    </div>
                    </div>
                </div>
                `;

            // Add hover effect styles
            const style = document.createElement('style');
            style.textContent = `
                .hover-shadow:hover {
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                    transform: translateY(-5px);
                    transition: all 0.3s ease-in-out;
                }
            `;
            document.head.appendChild(style);
            productCatalog.insertAdjacentHTML('beforeend', card);
        });

        currentPage++;
        isLoading = false;
    }

    function handleScroll() {
        const { scrollTop, scrollHeight, clientHeight } = document.documentElement;
        if (scrollTop + clientHeight >= scrollHeight - 100 && !isLoading) {
            loadMoreProducts();
        }
    }

    document.addEventListener('DOMContentLoaded', async () => {
        await fetchAllProducts();
        document.getElementById('loading').style.display = 'none'; // Hide loading screen
        document.getElementById('content').style.display = 'block'; // Show main content
        document.getElementById('featured-products').style.display = 'block'; // Show featured products
        window.addEventListener('scroll', handleScroll);
    });
</script>

<!-- Promotional Banner -->
<section class="promo-banner py-5 text-center text-white" style="background-color: #343a40;">
    <div class="container">
        <h2>Special Offer: 20% Off on All Items!</h2>
        <p>Use code <strong>SALE20</strong> at checkout. Offer valid until April 30, 2025.</p>
        <a href="{% url 'products' %}" class="btn btn-light btn-lg">
            <i class="fas fa-tags me-2"></i>Shop Now
        </a>
    </div>
</section>

<!-- Categories Section -->
<section class="categories-section py-5" id="categories">
    <div class="container">
        <div class="text-center mb-4">
            <h2 class="fw-bold">Explore Categories</h2>
            <p class="text-muted">Find products by category to suit your needs.</p>
        </div>
        <div class="row">
            <!-- Electronics -->
            <div class="col-md-2 mb-4">
                <div class="card h-100 text-center">
                    <div class="bg-light rounded-top" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-laptop fa-3x text-muted"></i>
                    </div>
                    <div class="card-body">
                        <h6 class="fw-bold">Electronics</h6>
                        <a href="#" class="btn btn-outline-dark">Explore</a>
                    </div>
                </div>
            </div>
            <!-- Fashion -->
            <div class="col-md-2 mb-4">
                <div class="card h-100 text-center">
                    <div class="bg-light rounded-top" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-tshirt fa-3x text-muted"></i>
                    </div>
                    <div class="card-body">
                        <h6 class="fw-bold">Fashion</h6>
                        <a href="#" class="btn btn-outline-dark">Explore</a>
                    </div>
                </div>
            </div>
            <!-- Furniture -->
            <div class="col-md-2 mb-4">
                <div class="card h-100 text-center">
                    <div class="bg-light rounded-top" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-chair fa-3x text-muted"></i>
                    </div>
                    <div class="card-body">
                        <h6 class="fw-bold">Furniture</h6>
                        <a href="#" class="btn btn-outline-dark">Explore</a>
                    </div>
                </div>
            </div>
            <!-- Mobile Phones -->
            <div class="col-md-2 mb-4">
                <div class="card h-100 text-center">
                    <div class="bg-light rounded-top" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-mobile-alt fa-3x text-muted"></i>
                    </div>
                    <div class="card-body">
                        <h6 class="fw-bold">Mobile Phones</h6>
                        <a href="#" class="btn btn-outline-dark">Explore</a>
                    </div>
                </div>
            </div>
            <!-- Home Appliances -->
            <div class="col-md-2 mb-4">
                <div class="card h-100 text-center">
                    <div class="bg-light rounded-top" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-blender fa-3x text-muted"></i>
                    </div>
                    <div class="card-body">
                        <h6 class="fw-bold">Home Appliances</h6>
                        <a href="#" class="btn btn-outline-dark">Explore</a>
                    </div>
                </div>
            </div>
           <!-- Sports -->
            <div class="col-md-2 mb-4">
                <div class="card h-100 text-center">
                    <div class="bg-light rounded-top" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-football-ball fa-3x text-muted"></i>
                    </div>
                    <div class="card-body">
                        <h6 class="fw-bold">Sports</h6>
                        <a href="#" class="btn btn-outline-dark">Explore</a>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>

<!-- Testimonials Section -->
<section class="testimonials-section py-5 bg-light">
    <div class="container">
        <div class="text-center mb-4">
            <h2 class="fw-bold">What Our Customers Say</h2>
            <p class="text-muted">Hear from our satisfied customers.</p>
        </div>
        <div class="row">
            <!-- Testimonial 1 -->
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body text-center">
                        <p class="text-muted fst-italic">"Amazing quality and fast delivery! Highly recommend this store."</p>
                        <h6 class="fw-bold mt-3">John Doe</h6>
                        <p class="text-muted">Verified Buyer</p>
                    </div>
                </div>
            </div>
            <!-- Testimonial 2 -->
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body text-center">
                        <p class="text-muted fst-italic">"Great customer service and fantastic products. Will shop again!"</p>
                        <h6 class="fw-bold mt-3">Jane Smith</h6>
                        <p class="text-muted">Verified Buyer</p>
                    </div>
                </div>
            </div>
            <!-- Testimonial 3 -->
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body text-center">
                        <p class="text-muted fst-italic">"The best online shopping experience I've ever had. Thank you!"</p>
                        <h6 class="fw-bold mt-3">Emily Johnson</h6>
                        <p class="text-muted">Verified Buyer</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Newsletter Subscription Section -->
<section class="newsletter-section py-5 text-center text-white" style="background-color: #007bff;">
    <div class="container">
        <h2 class="fw-bold">Stay Updated</h2>
        <p class="mb-4">Subscribe to our newsletter for the latest updates and exclusive offers.</p>
        <form class="d-flex justify-content-center">
            <input type="email" class="form-control w-50 me-2" placeholder="Enter your email" required>
            <button type="submit" class="btn btn-light">Subscribe</button>
        </form>
    </div>
</section>

<!-- Blog Section -->
<section class="blog-section py-5" style="background-color: #f8f9fa;">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold display-6">Latest from Our Blog</h2>
            <p class="text-muted fs-5">Stay informed with our latest news and articles.</p>
        </div>
        <div class="row g-4">
            <!-- Blog Post 1 -->
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm hover-shadow transition">
                    <img src="https://images.unsplash.com/photo-1517336714731-489689fd1ca8?auto=format&fit=crop&w=600&q=80" class="card-img-top rounded-top" alt="Top 10 Gadgets for 2023" style="height: 220px; object-fit: cover;">
                    <div class="card-body">
                        <h5 class="card-title fw-semibold">Top 10 Gadgets for 2023</h5>
                        <p class="card-text text-muted">Discover the must-have gadgets to enhance your lifestyle this year.</p>
                    </div>
                    <div class="card-footer bg-transparent border-0 pb-3 px-3">
                        <a href="#" class="btn btn-sm btn-outline-dark">Read More</a>
                    </div>
                </div>
            </div>

            <!-- Blog Post 2 -->
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm hover-shadow transition">
                    <img src="https://images.unsplash.com/photo-1600585154340-be6161a56a0c?auto=format&fit=crop&w=600&q=80" class="card-img-top rounded-top" alt="How to Choose the Perfect Furniture" style="height: 220px; object-fit: cover;">
                    <div class="card-body">
                        <h5 class="card-title fw-semibold">How to Choose the Perfect Furniture</h5>
                        <p class="card-text text-muted">Tips and tricks for selecting furniture that fits your style and needs.</p>
                    </div>
                    <div class="card-footer bg-transparent border-0 pb-3 px-3">
                        <a href="#" class="btn btn-sm btn-outline-dark">Read More</a>
                    </div>
                </div>
            </div>

            <!-- Blog Post 3 -->
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm hover-shadow transition">
                    <img src="https://cdn.mos.cms.futurecdn.net/jwrSBpoqnwfnJAX5yRmWNj-450-80.jpg.webp" class="card-img-top rounded-top" alt="Fashion Trends to Watch" style="height: 220px; object-fit: cover;">
                    <div class="card-body">
                        <h5 class="card-title fw-semibold">Fashion Trends to Watch</h5>
                        <p class="card-text text-muted">Stay ahead of the curve with the latest fashion trends for the season.</p>
                    </div>
                    <div class="card-footer bg-transparent border-0 pb-3 px-3">
                        <a href="#" class="btn btn-sm btn-outline-dark">Read More</a>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>



<!-- FAQ Section -->
<section class="faq-section py-5 bg-light">
    <div class="container">
        <div class="text-center mb-4">
            <h2 class="fw-bold">Frequently Asked Questions</h2>
            <p class="text-muted">Find answers to common questions about our store and services.</p>
        </div>
        <div class="accordion" id="faqAccordion">
            <div class="accordion-item">
                <h2 class="accordion-header" id="faqHeadingOne">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faqCollapseOne" aria-expanded="true" aria-controls="faqCollapseOne">
                        What is your return policy?
                    </button>
                </h2>
                <div id="faqCollapseOne" class="accordion-collapse collapse show" aria-labelledby="faqHeadingOne" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        We offer a 30-day return policy for all items. Please ensure the product is in its original condition.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="faqHeadingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqCollapseTwo" aria-expanded="false" aria-controls="faqCollapseTwo">
                        Do you offer international shipping?
                    </button>
                </h2>
                <div id="faqCollapseTwo" class="accordion-collapse collapse" aria-labelledby="faqHeadingTwo" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Yes, we ship to over 50 countries worldwide. Shipping fees and delivery times vary by location.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="faqHeadingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqCollapseThree" aria-expanded="false" aria-controls="faqCollapseThree">
                        How can I track my order?
                    </button>
                </h2>
                <div id="faqCollapseThree" class="accordion-collapse collapse" aria-labelledby="faqHeadingThree" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Once your order is shipped, you will receive a tracking number via email to monitor its progress.
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}
